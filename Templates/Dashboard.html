<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- W3school -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <!-- Css -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Bootstrap Glypicon Icon Link -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <!-- Css -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!--DataTable-->
    <link href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://kit.fontawesome.com/a4f690b883.js" crossorigin="anonymous"></script>
    <!-- Google Chart -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>

    <style>
        .footer-section {
            width: 100%;
            position: absolute;
            bottom: 0;
        }

        .onhover-sexy {
            transition: .5s;
            color: #000;
        }

        .onhover-sexy:hover {
            transition: .5s;
            opacity: 0.5;
            color: #c3c3c3;
        }

        li {
            list-style-type: none;
            display: flex;
            justify-content: start;
            padding-bottom: 20px;
            transition: 0.4s;
            cursor: pointer;
            
        }

        li:hover {
            transition: 0.4s;
            opacity: 0.7;
        }

        li>a {
            padding-left: 25px;
        }
        li>i {
            padding-left: 10px;
        }
        div.dataTables_wrapper {
            margin: 0 auto;
        }
        .item-card {
 
            box-shadow:5px 2px #227c54;
            background-image: linear-gradient(90deg, #227c54 0%, #50a7c2 100%);
            border-radius: 10px;
            padding-bottom: 50px;
            margin-bottom: 10px;
        }
        .barchart {
            position:reletive;
            display:flex;       
            height:60vh;
            border:2px solid white;
            align-items:center;
            
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);

        }
        .piechart {
            position:reletive;
            display:flex;
            height:60vh;
            border:2px solid white;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);

        }
        .Endpage{
            height:100px;
        }
        .myChartArea {
            display:flex;
            width:50%;
            height:40%;
            justify-centent:center;
            border:2px solid white;
            justify-content:center;
            
        }
        .myChartInvoiceUOM {
            display:flex;
            width:50%;
            height:40%;
            padding-right:10px;
            border:2px solid white;
            justify-content:center;
            

        }

        .myChartArea > iframe {
            display: block;
            position: relative !important;
        }
        .myChartInvoiceUOM > iframe {
            display: block;
            position: relative !important;
        }
   

    </style>

</head>

<body>
    <div class="w3-sidebar w3-animate-left" style="display:none; padding:0%; margin:0%; " id="mySidebar">
        <div class="col d-flex justify-content-end">
            <button class="btn btn-danger m-3" onclick="w3_close()">
                X
            </button>
        </div>
        <div class="">
            <div>
                <div>
                    {% include 'Sidebar.html' %} 
                </div>
            </div>
        </div>


    </div>


    <!--Main Display-->
    <div id="main">
        {% load crispy_forms_tags %}
        <div class="navbar" style="background-image:linear-gradient(90deg, #42948e 0%, #0fcd58 100%)">
            <button onclick="w3_open()" id="openNav" class="btn text-white" style="font-size: 25px" >&#9776;</button>
            <div class="col text-start">
                <h3 class="ps-2 text-white">Discrepancy Portal</h3>
            </div>
        </div>
        <!-- Kom Pass Side Bar -->
        <div class="container-fluid">
 
            <div class="row h-25 m-2">
                <div class="container-fluid card body-card mb-2">
                    <div class="card-header d-flex align-items-center py-2">
                        <h4 class="py-1"><i class="fa fa-bar-chart" style="font-size:27px"></i>
                        </i id="typewriter">Chart Overview</h4>
                    </div>
                    {% comment %} <div class="p-4">
                        <form method="GET">
                            {{myFilter.form}}
                            
                            
                            <button type="submit" class="btn btn-info btn-sm ms-4" style="backgroud-color:#02075d">Search</button>
                        </form>
                    </div> {% endcomment %}
                    
                </div>
                <div class="row mx-auto mt-2 " style="">
                    <div class="border col-xl-6 col-lg-6  col-md-12 col-sm-12 shadow flex d-flex justify-content-center align-items-center ">
                        <canvas id="myChartMonly" style="width:100%;max-width:600px" class="" >
                            <!--bar-->
                        </canvas>
                    </div>
                    <div class="border col-xl-6 col-lg-6 text-center  col-md-12 col-sm-12 shadow flex d-flex justify-content-center">
                        
                        <canvas id="myChartweekly" style="width:100%;max-width:600px" class="mt-5" >
                            <!--bar-->
                        </canvas>
                    </div>
                </div>
                <div class="row card my-4 ms-3 me-5">
                    <div class="p-4 me-3">
                        <form method="GET">
                            {{myFilter.form}}
                            
                            
                            <button type="submit" class="btn btn-info btn-sm ms-4" style="backgroud-color:#02075d">Search</button>
                        </form>
                    </div>
                    
                </div>
                <div class="row mx-auto d-flex justify-content-center align-items-center">
                    <div class="border col-xl-6 col-lg-5  col-md-12 col-sm-12 d-flex justify-content-center align-items-center shadow p-5" >
                        <div class="myChartArea flex d-flex justify-content-center align-items-center">
                            <canvas id="myChartArea" style=""></canvas>
                        </div>
                    </div>
                    <div class="border col-xl-6 col-lg-5  col-md-12 col-sm-12  d-flex justify-content-center align-items-center shadow p-5">
                        <div class="myChartArea ">
                            <canvas id="myChartInvoiceUOM" style=""></canvas>
                        </div>
                    </div>

                </div>
                <div class="row mx-auto mt-2" style="">
                    <div class="border col-xl-6 col-lg-6  col-md-12 col-sm-12 shadow flex d-flex justify-content-center align-items-center ">
                        <canvas id="TypeOfDiscrepancybar" style="width:100%;max-width:600px" class="" >
                            <!--bar-->
                        </canvas>
                    </div>
                
                    <div class="border col-xl-6 col-lg-6  col-md-12 col-sm-12 shadow flex d-flex justify-content-center align-items-center">
                    
                        <div  id="TypeOfDiscrepancypie"  style="width:75%" class="">
                            <!--Pie-->
                        </div>
                    </div>
                </div>

                    
            </div>  
            <div class="Exportcsv ms-5 mt-5 mb-2 w-25">
                <a href="GenCSV" class="btn btn-secondary btn-large ms-3" style="box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
                ">Export Csv</a>
            </div>

            <div class="row  ms-5 me-5 p-4">
                <table id="Dashboard" class="table table-striped display  nowrap" style="width:100%;">
                    <thead class="thead-dark text-center" style="font-size: 12px;">
                        <tr class= "text-center">
                            <th scope="col">Transaction_number</th>
                            <th scope="col">Type of Discrepancy</th>
                            <th scope="col">InvoiceUOM</th>
                            <th scope="col">Submit_date</th>
                            <th scope="col">Submit_by</th>
                            
                            <th scope="col">Area</th>
                            <th scope="col">status</th>
                            <th scope="col">Detail</th>
                            
                        </tr>
                    </thead>
                    <tbody style="font-size: 12px;">
                        {% for record in records %}
                        <tr>
                            <td style='text-align: center'>{{record.Transaction_Number}}
                          
                            </td>
                            <td style='text-align: center'>{{record.TypeOfDiscrepancy}}</td>
                            <td style='text-align: center'>{{record.InvoiceOUM}}</td>
                            <td style=''>{{record.SubmitDate}}</td>
                            <td style=''>{{record.SubmitBy}}</td>
                            
                            <td >{{record.Area}}</td>
                            <td style=' font-weight: bold '>{{record.Status}}</td>
                            <td style='text-align: center'>
                                <a class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#Dashboard{{record.Transaction_Number}}"><i class="fa fa-info-circle me-2" style="font-size:16px"></i>Detail</a>
                                <a class="btn btn-warning btn-sm" href={% url 'Genpdf' record.Transaction_Number  %} ><i class="fa fa-file-pdf-o" style="font-size:16px"></i>
                                </i>PDF</a>
                            </td>
                            <div class="modal fade" id="Dashboard{{record.Transaction_Number}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-xl">
                                    <div class="modal-content ">
                                        <div class="modal-header my-3 ms-4">
                                            <h4 class="modal-title" id=""><p class="">Shipment Record Detail</p></h4>
                                            <button type="button" class="btn-close me-3 my-2" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <div class=" container-fluid Detail"  >
                                                <div class="row m-2">
                                                    <div class="col">
                                                        Transaction Number: {{record.Transaction_Number}}
                                                    </div>
                                                    <div class="col">
                                                        Area : {{record.Area}}
                                                    </div>
                                                    <div class="col">
                                                        Fight Number: {{record.FlightNumber}}
                                                    </div>
                                                </div>
                                                <div class="row m-2">
                                                    <div class="col">
                                                        Mode of Transportation: {{record.ModeOfTranSportation}}
                                                    </div>
                                                    <div class="col">
                                                        Forwarder : {{record.Forwarder}}
                                                    </div>
                                                    <div class="col">
                                                        Shipper-Name: {{record.ShipperName}}
                                                    </div>
                                                </div>
                                                <div class="row m-2">
                                                    <div class="col">
                                                        Shipper-Country: {{record.ShipperCountry}}
                                                    </div>
                                                    <div class="col">
                                                        Customs-Declaration-Number : {{record.CustomDeclarationNumber}}
                                                    </div>
                                                    <div class="col">
                                                        Invoice-Number: {{record.InvoiceNumber}}
                                                    </div>
                                                </div>
                                                <div class="row m-2">
                                                    <div class="col">
                                                        Pick-Ticketor : {{record.PickTicket}}
                                                    </div>
                                                    <div class="col">
                                                        Bill_of_landing : {{record.BilOfLanding}}
                                                    </div>
                                                    <div class="col">
                                                        Supplier-Name: {{record.SupplierName}}
                                                    </div>
                                                </div>
                                                <div class="row m-2">
                                                    <div class="col">
                                                        Part-Number : {{record.PartNumber}}
                                                    </div>
                                                    <div class="col">
                                                        Invoice-Quantity : {{record.InvoiceQuantity}}
                                                    </div>
                                                    <div class="col">
                                                        Invoice -UOM: {{record.InvoiceUOM}}
                                                    </div>
                                                </div>
                                                <div class="row m-2">
                                                    <div class="col">
                                                        Unit-Price : {{record.UnitPrice}}
                                                    </div>
                                                    <div class="col">
                                                        Total-Package : {{record.TotalPackage}}
                                                    </div>
                                                    <div class="col">
                                                        Date-of-Incident: {{record.DateOfIncident}}
                                                    </div>
                                                </div>
                                                <div class="row m-2">
                                                    <div class="col">
                                                        Type-of-Discrepancy : {{record.TypeOfDiscrepancy}}
                                                    </div>
                                                    <div class="col">
                                                        Detail-of-Discrepancy : {{record.DetailOfDiscrepancy}}
                                                    </div>
                                                    <div class="col">
                                                        Submit-By: {{record.SubmitBy}}
                                                    </div>
                                                </div>

                                                {% comment %} <div class="row m-2">
                                                    <div class="col">
                                                        Action : {{record.ActionCause.RootCause}}
                                                    </div>
                                                    <div class="col">
                                                        RootCause : {{record.ActionCause.RootCause}}
                                                    </div>
                                                    <div class="col">
                                                        Report-By: {{record.ActionCause.ActionID}}
                                                    </div>
                                                </div> {% endcomment %}
                                                
                                                <div class="row m-2">
                                                    <div class="col-4">
                                                        Submit-Date : {{record.SubmitDate}}
                                                    </div>
                                                    <div class="col-4">
                                                        Status :<span style="font-weight:bold;"> {{record.Status}} </span>
                                                    </div>
                                                    {%if record.ProcessingTime != 'None' %}
                                                    <div class="col-4">
                                                        Processing Time: {{record.ProcessingTime}}
                                                    </div>
                                                    {%endif%}
                                                </div>
                                                <div class="row m-2">
                                                    <div class="col">
                                                        <a href="/media/{{record.ShippingDocument}}">{{record.ShippingDocument|default:""}}</a>
                                                    </div>
                                                    <div class="col">
                                                        <a href="/media/{{record.Other}}">{{record.Other|default:""}}</a>
                                                    </div>
                                                    <div class="col">
                                                        <button onclick="window.print()">Print this page</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div style="height:100px">
                </div>
            </div>

        </div>

    </div>
    <script>
        function w3_open() {
            document.getElementById("main").style.marginLeft = "20%";
            document.getElementById("mySidebar").style.width = "20%";
            document.getElementById("main").style.width = "80%";
            document.getElementById("mySidebar").style.display = "block";
            document.getElementById("openNav").style.display = 'none';
        }
        function w3_close() {
            document.getElementById("main").style.marginLeft = "0%";
            document.getElementById("main").style.width = "100%";
            document.getElementById("mySidebar").style.display = "none";
            document.getElementById("openNav").style.display = "inline-block";
        }
    </script>
    <!-- Bootsrap-Js-link-->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
    <!--Jqury-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!--Data Table-->
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <!--ChartJs-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <!--Plotly-->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>
    <script>
        var xValues = ["Shortage Quantity", "Over Quantity", "Wrong Parts", "Mixed Parts", "PO problems"];
        var yValues = [{{Shortage}},{{Over}}, {{Wrong}}, {{Mixed}}, {{PO}}];
        var barColors = ["darkblue", "green","blue","orange","purple"];
        
        new Chart("TypeOfDiscrepancybar", {
          type: "bar",
          data: {
            labels: xValues,
            datasets: [{
              backgroundColor: barColors,
              data: yValues
            }]
          },
          options: {
            legend: {display: false},
            title: {
              display: true,
              text: "Type Of Discrepancy"
            }
          }
        });
    </script>
    <script>
        var xArray = ["Shortage Quantity", "Over Quantity", "Wrong Parts", "Mixed Parts", "PO problems"];
        var yArray = [{{Shortage}},{{Over}}, {{Wrong}}, {{Mixed}}, {{PO}}];
        var layout = {title:"Type of Discrepancy"};
        var data = [{labels:xArray, values:yArray, type:"pie"}];
        Plotly.newPlot("TypeOfDiscrepancypie", data, layout);
    </script>
    <script>
        $("document").ready(function () {
          $("#Dashboard").dataTable({
            order: [[0, 'desc']],
          });
          
        });
    </script> 
    <!---->
    <script>
        var xValues = ["Local", "Oversea"];
        var yValues = [{{local}}, {{Oversea}}];
        var barColors = [
          "#894db0",
          "#7077b5",

        ];
        
        new Chart("myChartArea", {
          type: "doughnut",
          data: {
            labels: xValues,
            datasets: [{
              backgroundColor: barColors,
              data: yValues
            }]
          },
          options: {
            title: {
              display: true,
              text: "Area"
            }
          }
        });
    </script>
    <!--Invoice-->
    <script>
        var xValues = ["Air", "Truck", "Ocean"];
        var yValues = [{{Air}}, {{Truck}}, {{Ocean}}];
        var barColors = [
          "#ba439a",
          "#26d1b7",
          "#76d126",
       
        ];
        
        new Chart("myChartInvoiceUOM", {
          type: "pie",
          data: {
            labels: xValues,
            datasets: [{
              backgroundColor: barColors,
              data: yValues
            }]
          },
          options: {
            title: {
              display: true,
              text: "Mode Of TranSportation",
             
            }
          }
        });
    </script>
    <!--Monly-->
    <script>
        var xValues = ["January", " February", "March", "April","May","June","July","August","September","October","November","Demcember",];
        var yValues = [{% for i in Monly%} "{{i}}", {% endfor %}];
        var barColors = ["red", "green","blue","orange","brown","blue","red", "green","blue","orange","brown","blue"];
        
        new Chart("myChartMonly", {
          type: "bar",
          data: {
            labels: xValues,
            datasets: [{
              backgroundColor: barColors,
              data: yValues
            }]
          },
          options: {
            legend: {display: false},
            title: {
              display: true,
              text: "Monthly Cases"
            }
          }
        });
    </script>
    <!--Weekly-->
    <script>
        var xValues = ["Sunday", "Monday","Tuesday","Wendesday","Thurday","Friend","Saturday"];
        var yValues = [{% for i in weekly %} "{{i}}", {% endfor %}];
        
        new Chart("myChartweekly", {
          type: "line",
          data: {
            labels: xValues,
            datasets: [{
              fill: false,
              lineTension: 0,
              backgroundColor: "rgba(0,0,255,1.0)",
              borderColor: "rgba(0,0,255,0.1)",
              data: yValues
            }]
          },
          options: {
            legend: {display: false},
            scales: {
              yAxes: [{ticks: {min: 0, max:{{maxweek}}}}],
            }
            
          }
        });
    </script>
        

        
    

</body>

</html>